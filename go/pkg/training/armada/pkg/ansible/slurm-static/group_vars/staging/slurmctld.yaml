# INTEL CONFIDENTIAL
# Copyright (C) 2023 Intel Corporation
iptables_rules:
  - { chain: 'INPUT', source: 'localhost', protocol: 'all', jump: 'ACCEPT' }
  - { chain: 'INPUT', protocol: 'tcp', destination_port: '22', match: 'conntrack', ctstate: 'RELATED,ESTABLISHED', jump: 'ACCEPT' }
  - { chain: 'INPUT', match: 'state', match: 'conntrack', ctstate: 'RELATED,ESTABLISHED', jump: 'ACCEPT' }
  - { chain: 'INPUT', source: '100.80.63.63', protocol: 'tcp', destination_port: '22', jump: 'ACCEPT' }
  - { chain: 'INPUT', source: '100.64.17.3', protocol: 'tcp', destination_port: '22', jump: 'ACCEPT' }
  - { chain: 'INPUT', source: '100.64.17.4', protocol: 'tcp', destination_port: '22', jump: 'ACCEPT' }
  - { chain: 'INPUT', source: '100.64.17.5', protocol: 'tcp', destination_port: '22', jump: 'ACCEPT' }
  - { chain: 'INPUT', source: '100.80.63.218', protocol: 'tcp', destination_port: '3306', jump: 'ACCEPT' }
  - { chain: 'INPUT', source: '100.80.63.105', protocol: 'tcp', destination_port: '3306', jump: 'ACCEPT' }
  - { chain: 'INPUT', source: '100.80.63.0/24', protocol: 'tcp', destination_ports: '389,636,6817,6001:6300', jump: 'ACCEPT' }
  - { chain: 'INPUT', source: '146.152.227.31', protocol: 'tcp', destination_port: '8000', jump: 'ACCEPT' }
  - { chain: 'INPUT', source: '10.45.117.164', protocol: 'tcp', destination_port: '8000', jump: 'ACCEPT' }
  - { chain: 'INPUT', source: '10.45.117.165', protocol: 'tcp', destination_port: '8000', jump: 'ACCEPT' }
  - { chain: 'INPUT', source: '10.45.117.166', protocol: 'tcp', destination_port: '8000', jump: 'ACCEPT' }
  - { chain: 'INPUT', source: '146.152.227.33', protocol: 'tcp', destination_port: '3000', jump: 'ACCEPT' }
  - { chain: 'INPUT', jump: 'DROP' }
  - { chain: 'FORWARD', match: 'state', ctstate: 'RELATED,ESTABLISHED', jump: 'ACCEPT' }
  - { chain: 'FORWARD', jump: 'DROP' }
  - { chain: 'OUTPUT', match: 'state', ctstate: 'RELATED,ESTABLISHED', jump: 'ACCEPT' }
  - { chain: 'OUTPUT', protocol: 'tcp', destination_port: '22', match: 'conntrack', ctstate: 'ESTABLISHED', jump: 'ACCEPT' }

