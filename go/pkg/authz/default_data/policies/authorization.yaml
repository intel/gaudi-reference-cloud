# INTEL CONFIDENTIAL
# Copyright (C) 2023 Intel Corporation

# cloud_account_admin
- subject: cloud_account_admin
  object: /v1/authorization/actions
  action: POST
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/resources
  action: GET
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/users
  action: GET
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/users/:userId
  action: GET
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/users/:userId/roles
  action: POST
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/users/:userId/roles
  action: PUT
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles
  action: POST
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles
  action: GET
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles/:id
  action: GET
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles/:id
  action: PUT
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles/:id
  action: DELETE
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles/:id/resources
  action: POST
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles/:id/users
  action: POST
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles/:id/resources
  action: DELETE
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles/:id/users
  action: DELETE
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles/:cloudAccountRoleId/permissions
  action: POST
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles/:cloudAccountRoleId/permissions/:id
  action: PUT
  expression: "true"
- subject: cloud_account_admin
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles/:cloudAccountRoleId/permissions/:id
  action: DELETE
  expression: "true"

# cloud_account_member
- subject: cloud_account_member
  object: /v1/authorization/actions
  action: POST
  expression: "true"
- subject: cloud_account_member
  object: /v1/authorization/resources
  action: GET
  expression: "true"
- subject: cloud_account_member
  object: /v1/authorization/cloudaccounts/:cloudAccountId/roles
  action: GET
  expression: "true" # TODO: adjust query params to lookup the requested actions
- subject: cloud_account_member
  object: /v1/authorization/cloudaccounts/:cloudAccountId/users/:userId
  action: GET
  expression: "r.sub == keyGetAuthz(r.obj,p.obj,'userId')"