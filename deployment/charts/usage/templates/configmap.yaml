apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "idc-common.fullname" . }}
  namespace: {{ include "idc-common.namespace" . }}  
data:
  config.yaml: |
    listenPort: {{ include "idc-common.listenPort" . }}
    database:
      url: {{ include "idc-common.db-url" . }}
      usernameFile: /vault/secrets/db_username
      passwordFile: /vault/secrets/db_password
    usageSchedulerInterval: {{ .Values.usageSchedulerInterval }}
    productUsageSchedulerInterval: {{ .Values.productUsageSchedulerInterval }}
    migrationResourcePaginationSize: {{ .Values.migrationResourcePaginationSize }}
    storageServiceTypes:
    {{- if $.Values.storageServiceTypes }}
      {{- range $value := $.Values.storageServiceTypes }}
        - {{ $value }}
      {{- end }}
    {{- end }}
    storageTimeMetricUnitType: {{ .Values.storageTimeMetricUnitType }}
    storageMetricUnitType: {{ .Values.storageMetricUnitType }}
    features:
          usageScheduler: {{ .Values.features.usageScheduler }}
          productUsageScheduler: {{ .Values.features.productUsageScheduler }}
