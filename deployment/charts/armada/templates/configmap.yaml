apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "idc-common.fullname" . }}
  namespace: {{ include "idc-common.namespace" . }}
data:
  config.yaml: |
    listenPort: {{ include "idc-common.listenPort" . }}
    database:
      url: {{ include "idc-common.db-url" . }}
      usernameFile: /vault/secrets/db_username
      passwordFile: /vault/secrets/db_password
    globalConfig:
      schedulerIntervalSeconds: {{ .Values.globalConfig.interval }}
      maxClustersPerAccount: {{ .Values.globalConfig.maxClustersPerAccount }}
      maxNodesPerAccount: {{ .Values.globalConfig.maxNodesPerAccount }}
      maxVnetsPerAccount: {{ .Values.globalConfig.maxVnetsPerAccount }}
      maxStorageSizePerAccount: {{ .Values.globalConfig.maxStorageSizePerAccount }}
    cloudConfig:
      idc:
        computeGrpcAPIEndpoint: {{ .Values.computeGrpcAPIEndpoint | quote }}
        foundationGrpcAPIEndpoint: {{ .Values.cloudConfig.idc.foundationGrpcAPIEndpoint | quote }}
        storageGrpcAPIEndpoint: {{ .Values.storageGrpcAPIEndpoint | quote }}
